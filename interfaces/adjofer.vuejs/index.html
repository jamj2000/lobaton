<!DOCTYPE html>
<html lang="es">
   <meta charset="UTF-8">
   <title>Prueba de sidebar</title>
   <meta name="viewport" content="width=device-width, initial-scale=1">

   <!-- Leaflet -->
   <link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css"
         integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
         crossorigin="">
   <script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"
            integrity="sha512-QVftwZFqvtRNi0ZyCtsznlKSWOStnDORoefr1enyq5mVL4tmKB3S/EnC3rRJcxCPavG10IcrVGSmPh6Qw5lwrg=="
            crossorigin=""></script>

   <!-- Extensión para el soporte de iconos mutables -->
   <script src="../../dist/leafext.js"></script>

   <!-- Plugin: Añade botón para maximizar el mapa -->
   <script src='https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/Leaflet.fullscreen.min.js'></script>
   <link href='https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/leaflet.fullscreen.css' rel='stylesheet'>

   <!-- Plugin: Agrupa marcas contiguas -->
   <script src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.js"></script>
   <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css">
   <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css">

   <!-- Plugin: Menu contextual con el botón derecho -->
   <script src="https://aratcliffe.github.io/Leaflet.contextmenu/dist/leaflet.contextmenu.js"></script>
   <link rel="stylesheet" href="https://aratcliffe.github.io/Leaflet.contextmenu/dist/leaflet.contextmenu.css">

   <!-- Librería turf: necesaria para isocronas -->
   <script src='https://npmcdn.com/@turf/turf/turf.min.js'></script>

   <!-- Fuse.js: Fuzzy-search (cajetín de búsqueda de centros -->
   <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/1.2.2/fuse.min.js"></script>

   <!-- Mapa de oferta y adjudicaciones -->
   <script src="../../dist/maps/adjofer/map.js"></script>

   <!-- Plugin: Sidebar -->
   <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
   <script src="https://cdn.jsdelivr.net/npm/leaflet-sidebar-v2@3.1.1/js/leaflet-sidebar.min.js"></script>
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet-sidebar-v2@3.1.1/css/leaflet-sidebar.min.css">

   <!-- Bootstrap 4 CSS -->
   <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap4c-custom-switch@1.1.2/dist/css/component-custom-switch.min.css">



   <!-- Particularidades de esta página -->
   <script src="scripts/main.js"></script>
   <link rel="stylesheet" href="../../dist/maps/adjofer/css/adjofer.css">
   <link rel="stylesheet" href="css/main.css">

   <style>
      /*<![CDATA[*/
      html { height: 100%; }
      body {
         margin: 0; padding: 0;
         height: 100%;
      }
      #map {
        margin: 0;
        padding: 0;
        height: 100%
      }

      .filtered {
         filter: grayscale(100%);
      }
      /*]]>*/
   </style>
   <!-- HTML para los iconos que se decoran con CSS -->
   <template id="iconocss">
      <div class="content"><span></span></div>
      <div class="arrow"></div>
   </template>

   <div id="map"></div>

   <!-- Barra lateral -->
   <div id="sidebar" class="leaflet-sidebar collapsed">

      <!-- Navegación -->
      <div class="leaflet-sidebar-tabs">
         <!-- Arriba -->
         <ul role="tablist">
            <li><a><i class="fa fa-arrow-up"></i></a></li>
            <li><a><i class="fa fa-square-o"></i></a></li>
            <li><a href="#ajustes" role="tab"><i class="fa fa-cog"></i></a></li>
            <li class="disabled"><a href="#correcciones" role="tab"><i class="fa fa-filter"></i></a></li>
            <li class="disabled"><a href="#busqueda" role="tab"><i class="fa fa-search"></i></a></li>
            <li class="disabled"><a href="#centro" role="tab"><i class="fa fa-folder-open"></i></a></li>
            <li class="disabled"><a href="#solicitud" role="tab"><i class="fa fa-sort-amount-asc"></i></a></li>
         </ul>

         <!-- Abajo -->
         <ul role="tablist">
            <li><a href="#selector" role="tab"><i class="fa fa-sign-in active"></i></a></li>
            <li class="disabled"><a href="#info" role="tab"><i class="fa fa-info-circle"></i></a></li>
            <li><a href="https://github.com/sio2sio2/lobaton" target="_blank"><i class="fa fa-github"></i></a></li>
         </ul>
      </div>

      <!-- Paneles -->
      <div class="leaflet-sidebar-content">
         <div class="leaflet-sidebar-pane" id="ajustes">
            <h1 class="leaflet-sidebar-header">
               Ajustes
               <span class="leaflet-sidebar-close"><i class="fa fa-caret-left"></i></span>
            </h1>

            <div class="section-cardbox-content">
               <fieldset class="form-group">
                  <legend>Ajustes generales</legend>
                  <ajuste v-for="a in ajustes" :key="a.opt" :a="a"></ajuste>
               </fieldset>
            </div>

            <script type="text/x-template" id="ajuste">
               <div class="form-group row">
                  <label class="col-form-label col-10" :for="id">{{a.desc}}</label>
                  <div class="custom-switch custom-switch-xs pl-0 col-2">
                     <input type="checkbox" :name="a.opt" :value="JSON.stringify(a.value || '{}')"
                            @change="ajustar" :id="id" v-model="checked"
                            class="custom-switch-input filtro">
                     <label class="custom-switch-btn" :for="id"></label>
                  </div>
               </div>
            </script>
         </div>

         <div class="leaflet-sidebar-pane" id="selector">
            <h1 class="leaflet-sidebar-header">
               Especialidad
               <span class="leaflet-sidebar-close"><i class="fa fa-caret-left"></i></span>
            </h1>

            <div id="esp">
               <label>Escriba o seleccione una especialidad
                  <input list="especialidades" class="custom-select" placeholder="Escoja especialidad..."
                         value="" @input="selEspec" autocomplete=off autofocus>
                  <datalist id="especialidades">
                     <option v-for="(codigo) in Object.keys(todas)" :value="codigo">{{todas[codigo]}}
                  </datalist>
               </label>
            </div>
         </div>

         <div class="leaflet-sidebar-pane" id="centro">
            <h1 class="leaflet-sidebar-header">
               Información del centro
               <span class="leaflet-sidebar-close"><i class="fa fa-caret-left"></i></span>
            </h1>

            <p>Aquí se muestra la información del centro</p>
         </div>


         <div class="leaflet-sidebar-pane" id="correcciones">
            <h1 class="leaflet-sidebar-header">
               Filtrado
               <span class="leaflet-sidebar-close"><i class="fa fa-caret-left"></i></span>
            </h1>

            <div class="section-cardbox-content">
               <correccion v-for="c in correcciones" :c="c" :key="c.correccion" />
            </div>

            <script type="text/x-template" id="correccion">
               <fieldset :id="id" class="form-group">
                  <legend>{{c.titulo}}</legend>
                  <small class="help form-text text-muted">{{c.desc}}</small>
                  <opcion-corr v-for="(o, index) in c.opciones" :o="o" :idx="index" :key="index" />
               </fieldset>
            </script>

            <script type="text/x-template" id="opcion-corr">
               <div v-if="$parent.c.nombre === 'turno'" class="form-group row">
                   <label class="col-form-label col-10" :for="id">{{o.label}}</label>
                   <div class="custom-switch custom-switch-xs pl-0 col-2">
                     <input type="checkbox" class="custom-switch-input correccion"
                            :id="id" :name="$parent.c.campo" :value="o.value" @change="prepararOperacion($event.target)"
                            v-model="checked" :disabled="disabled">
                     <label class="custom-switch-btn" :for="id"></label>
                   </div>
               </div>
               <opcion-adjref v-else-if="$parent.c.nombre === 'adjref'" />
               <div v-else class="form-group row">
                   <label class="col-form-label col-10" :for="id">{{o.label}}</label>
                   <div class="custom-switch custom-switch-xs pl-0 col-2">
                     <input type="checkbox" class="custom-switch-input correccion"
                            :id="id" :name="o.campo" :value="o.value" @change="prepararOperacion($event.target)"
                            v-model="checked" :disabled="disabled">
                     <label class="custom-switch-btn" :for="id"></label>
                   </div>
               </div>
            </script>

            <script type="text/x-template" id="opcion-adjref">
               <form class="form-group row" autocomplete=off>
                  <div class="col-form-label col-10">
                     <select name="colectivo" class="custom-select custom-select-sm mb-2" required>
                        <option disabled selected label="-- Colectivo --"></option>
                        <option v-for="(co, index) of $parent.o.colectivos" :key="index"
                                :value="co.letra">{{co.nombre}}</option>
                     </select>
                     <div class="row">
                        <input class="col-4 form-control-sm is-valid" placeholder="Escalafón"
                               type="number" id="escalafon" name="escalafon" required disabled>
                        <fieldset div class="col-8 text-right" disabled>
                           <input type="number" name="anno" placeholder="años"
                                  class="col-3 form-control-sm is-valid" min=0 max=40>
                           <span class="col-0 col-form-label">/</span>
                           <input type="number" name="mes" placeholder="meses"
                                  class="col-3 form-control-sm is-vslid" min=0 max=12>
                           <span class="col-0 col-form-label">/</span>
                           <input type="number" name="dia" placeholder="dias"
                                  class="col-3 form-control-sm is-valid" min=0 max=30>
                        </fieldset>
                     </div>
                  </div>
                   <div class="custom-switch custom-switch-xs pl-0 col-2">
                     <input type="checkbox" class="custom-switch-input correccion" id="correct:adjref_0"
                            v-model="checked" :disabled="disabled" @change="$parent.prepararOperacion($event.target)">
                     <label class="custom-switch-btn" for="correct:adjref_0"></label>
                   </div>
               </form>
            </script>

         </div>

         <div class="leaflet-sidebar-pane" id="info">
            <h1 class="leaflet-sidebar-header">
               Estado del mapa
               <span class="leaflet-sidebar-close"><i class="fa fa-caret-left"></i></span>
            </h1>

            <section class="card">
               <article class="card-body">
                  <h5 class="card-title">Datos</h5>
                  <h6 class="card-subtitle mb-2 text-muted">Asociados al archivo de especialidad</h6>
                  <div class="card-text">
                     <dl class="row">
                        <dt class="col-8">Especialidad</dt>
                        <dd class="col-4 text-right">{{especialidad}}</dd>
                        <dt class="col-8">Colocación</dt>
                        <dd class="col-4 text-right">{{colocacion}}</dd>
                        <dt class="col-8">Plantilla orgánica</dt>
                        <dd class="col-4 text-right">{{organica}}</dd>
                        <dt class="col-8">Oferta secundaria</dt>
                        <dd class="col-4 text-right">{{ofertasec}}</dd>
                        <dt class="col-8">Oferta FP</dt>
                        <dd class="col-4 text-right">{{ofertafp}}</dd>
                        <dt class="col-8">Vacantes telefónicas</dt>
                        <dd class="col-4 text-right">{{vt}}</dd>
                        <dt class="col-8">Concurso de traslados</dt>
                        <dd class="col-4 text-right">{{cgt}}</dd>
                     </dl>
                  </div>
               </article>
               <article class="card-body">
                  <h5 class="card-title">Estadísticas</h5>
                  <h6 class="card-subtitle mb-2 text-muted">Del uso y estado del mapa</h6>
                  <div class="card-text">
                     <dl class="row">
                        <dt class="col-8">Total de centros</dt>
                        <dd class="col-4 text-right">{{centros}}</dd>
                        <dt class="col-8">Centros visibles</dt>
                        <dd class="col-4 text-right">{{visibles}}</dd>
                        <dt class="col-8">Centros filtrados</dt>
                        <dd class="col-4 text-right">{{filtrados}}</dd>
                        <dt class="col-8">Consultas a <a href="https://openrouteservice.org/" target="_blank">OpenRouteService</a></dt>
                        <dd class="col-4 text-right">{{contador}}</dd>
                     </dl>
                  </div>
               </article>
               <article class="card-body">
                  <h5 class="card-title">Entidades geográficas</h5>
                  <h6 class="card-subtitle mb-2 text-muted">Detalle de las entidades del mapa</h6>
                  <div class="card-text">
                     <dl class="row">
                        <dt class="col-4">Origen</dt>
                        <dd class="col-8 text-right text-truncate">
                           <a href="" v-if="origen" @click="irLugar($event, origen)">{{estado_origen}}</a>
                           <span v-else>{{estado_origen}}</span>
                        </dd>
                        <dt class="col-4">Seleccionado</dt>
                        <dd class="col-8 text-right text-truncate">
                           <a href="" v-if="seleccionado" @click="irLugar($event, seleccionado)">{{estado_seleccionado}}</a>
                           <span v-else>{{estado_seleccionado}}</span>
                        </dd>
                        <dt class="col-4">Isocronas</dt>
                        <dd class="col-8 text-right text-truncate">{{estado_isocronas}}</dd>
                        <dt class="col-4">Ruta</dt>
                        <dd class="col-8 text-right text-truncate">
                           <a href="" v-if="ruta" @click="irLugar($event, ruta.destino)">{{estado_destino}}</a>
                           <span v-else>{{estado_destino}}</span>
                        </dd>
                        <dd class="col-11 offset-1">
	                        <dl class="row">
                              <dt class="col-4">Tiempo</dt>
                              <dd class="col-8 text-right text-truncate">{{tiempo}}</dd>
                              <dt class="col-4">Distancia</dt>
                              <dd class="col-8 text-right text-truncate">{{distancia}}</dd>
                           </dl>
                        </dd>
                     </dl>
                  </div>
               </article>
               <footer class="card-body text-center">
                  <input style="z-index: -1; opacity: .01; height:0; position: absolute" name="link" type="text" :value="link">
                  <button type="button" class="btn btn-primary" @click="copyToClipboard">Compartir mapa</button>
               </footer>
            </section>

         </div>

         <div class="leaflet-sidebar-pane" id="solicitud">
            <h1 class="leaflet-sidebar-header">
               Petición de destinos
               <span class="leaflet-sidebar-close"><i class="fa fa-caret-left"></i></span>
            </h1>

            <p>Esta pestaña está dedicada a la petición de destinos</p>
         </div>

         <div class="leaflet-sidebar-pane" id="busqueda">
            <h1 class="leaflet-sidebar-header">
               Búsqueda de centros
               <span class="leaflet-sidebar-close"><i class="fa fa-caret-left"></i></span>
            </h1>
            <article>
               <input name="centro" @input="sugerir" placeholder="Escriba el nombre...">
               <ul>
                  <li v-for="c in candidatos"><data :value="c.getData().id.cod" @click="seleccionar">
                     <span>{{String(c.getData().id.cp).padStart(5, "0").substring(0, 2)}}</span>
                     <span>{{c.getData().id.nom}}</span>
                  </data> </li>
               </ul>
            </article>
         </div>
      </div>
   </div>

   <!-- Bootstrap 4 Native (sin JQuery) -->
   <script src="https://cdn.jsdelivr.net/npm/bootstrap.native@2.0.26/dist/bootstrap-native-v4.min.js"></script>

   <!-- development version, includes helpful console warnings -->
   <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
</html>
